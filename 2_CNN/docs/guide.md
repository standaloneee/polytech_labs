# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≥–∞–π–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É 2_CNN

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Å–∫—Ä–∏–ø—Ç–æ–≤)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã-–º–æ–¥–µ–ª–µ–π)
5. [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤)
6. [–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#–≤—ã–≤–æ–¥—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**–¶–µ–ª—å:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ä–≥–∞–Ω–æ–≤ (OrganCMNIST) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π.

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** **91.26%** test accuracy (–∞–Ω—Å–∞–º–±–ª—å 5 –º–æ–¥–µ–ª–µ–π + TTA)

**–ü—Ä–µ–≤–∑–æ–π–¥–µ–Ω—ã –±–µ–Ω—á–º–∞—Ä–∫–∏:**
- MLP (80.83%) ‚Üí +10.43%
- ResNet-18 –∏–∑ —Å—Ç–∞—Ç—å–∏ MedMNIST v2 (87.7%) ‚Üí +3.56%
- OrganAMNIST Axial (90.7%) ‚Üí +0.56%

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
2_CNN/
‚îú‚îÄ‚îÄ scripts/python/                    # –í—Å–µ Python —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ train_cnn.py                      # Baseline –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ experiments.py                    # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ augmentation_exp.py               # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ ensemble.py                       # –ê–Ω—Å–∞–º–±–ª—å 5 –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ ensemble_large.py                 # –ê–Ω—Å–∞–º–±–ª—å 10 –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ weighted_ensemble.py              # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ test_time_augmentation.py         # TTA –¥–ª—è 10 –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ tta_original_ensemble.py          # TTA –¥–ª—è 5 –º–æ–¥–µ–ª–µ–π (—Ñ–∏–Ω–∞–ª!)
‚îÇ   ‚îú‚îÄ‚îÄ best_models_ensemble.py           # –í—ã–±–æ—Ä —Ç–æ–ø-5 –∏–∑ 10
‚îÇ   ‚îî‚îÄ‚îÄ visualize_results.py              # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ results/                           # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ baseline_results/                 # Baseline CNN
‚îÇ   ‚îú‚îÄ‚îÄ experiments_results/              # JSON –∏ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ *.txt                             # –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ *.png                             # –ì—Ä–∞—Ñ–∏–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ notebooks/                         # Jupyter Notebook
‚îÇ   ‚îî‚îÄ‚îÄ cnn_organcmnist.ipynb
‚îÇ
‚îî‚îÄ‚îÄ docs/                              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ guide.md                          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
    ‚îú‚îÄ‚îÄ final_report.txt                  # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
    ‚îú‚îÄ‚îÄ MEDMNIST_BENCHMARKS.md            # –ë–µ–Ω—á–º–∞—Ä–∫–∏ –∏–∑ —Å—Ç–∞—Ç—å–∏
    ‚îî‚îÄ‚îÄ GPU_SETUP.md                      # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GPU
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

### 1. train_cnn.py - Baseline CNN

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π baseline CNN –º–æ–¥–µ–ª–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Conv2d(1, 32, 3) -> ReLU -> MaxPool(2)
Conv2d(32, 64, 3) -> ReLU -> MaxPool(2)
Flatten -> FC(64*5*5, 128) -> ReLU -> Dropout(0.5) -> FC(128, 11)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Optimizer: Adam (lr=0.001)
- Epochs: 20
- Batch size: 128
- Dropout: 0.5

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 89.96% test accuracy

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/train_cnn.py
```

---

### 2. experiments.py - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 7 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä CNN –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
1. **Baseline CNN** - –ø—Ä–æ—Å—Ç–∞—è CNN (89.96%)
2. **DeepCNN** - 4 conv —Å–ª–æ—è (89.35%)
3. **BatchNormCNN** - —Å Batch Normalization (88.81%)
4. **ResNet-like** - skip connections (89.42%)
5. **ResNet-like + Higher LR** - LR=0.002 **(90.91% - –ª—É—á—à–∞—è!)** ‚≠ê
6. **GlobalPoolCNN** - —Å Global Average Pooling (89.23%)
7. **LargeKernelCNN** - kernel 5√ó5 (88.69%)

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**
- ResNet-like —Å Higher LR (0.002) –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **90.91%**
- Skip connections —É–ª—É—á—à–∞—é—Ç –æ–±—É—á–µ–Ω–∏–µ
- Batch Normalization –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π learning rate –∫—Ä–∏—Ç–∏—á–µ–Ω (0.002 > 0.001)

**–ó–∞–ø—É—Å–∫:**
```bash
python -u scripts/python/experiments.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~30 –º–∏–Ω—É—Ç

---

### 3. augmentation_exp.py - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∏—è–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
1. **ResNet-like (–±–µ–∑ aug)** - baseline (90.68%)
2. **+ Horizontal Flip** (90.48%)
3. **+ Vertical Flip** (90.34%)
4. **+ Rotation ¬±10¬∞** (90.24%)
5. **+ Rotation ¬±15¬∞** (89.93%)
6. **+ Rotation ¬±20¬∞** (89.45%)
7. **+ Random Erasing** (89.12%)

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**
- ‚ö†Ô∏è **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –£–•–£–î–®–ê–ï–¢ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 28√ó28 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö!**
- –ú–∞–ª–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å–∏–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –õ–µ–≥–∫–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è (flip, rotation ¬±10¬∞) —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ
- –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **90.68%** –±–µ–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

**–ó–∞–ø—É—Å–∫:**
```bash
python -u scripts/python/augmentation_exp.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~35 –º–∏–Ω—É—Ç

---

### 4. ensemble.py - –ê–Ω—Å–∞–º–±–ª—å 5 –º–æ–¥–µ–ª–µ–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—É—á–µ–Ω–∏–µ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ 5 –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ soft voting.

**–°–æ—Å—Ç–∞–≤ –∞–Ω—Å–∞–º–±–ª—è:**
1. BatchNormCNN (seed=42) - 88.81%
2. BatchNormCNN (seed=52) - 89.12%
3. ResNetLikeCNN (seed=62) - 89.57%
4. ResNetLikeCNN (seed=72) - 89.42%
5. DeepCNN (seed=82) - 89.35%

**–ú–µ—Ç–æ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è:** Soft Voting (—É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **91.16%** test accuracy (+1.25% –Ω–∞–¥ –ª—É—á—à–µ–π –æ–¥–∏–Ω–æ—á–Ω–æ–π –º–æ–¥–µ–ª—å—é)

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/ensemble.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~25 –º–∏–Ω—É—Ç

---

### 5. ensemble_large.py - –ê–Ω—Å–∞–º–±–ª—å 10 –º–æ–¥–µ–ª–µ–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã —á—Ç–æ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∞–Ω—Å–∞–º–±–ª—è —É–ª—É—á—à–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** 10 ResNet-like –º–æ–¥–µ–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏:
- Learning rates (0.0015, 0.002, 0.0025)
- Dropout rates (0.2, 0.25, 0.3, 0.35, 0.4)
- Hidden dimensions (64, 72, 80, 96)
- Seeds (42-132)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **91.02%** test accuracy

**–í—ã–≤–æ–¥:** ‚ùå –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å 5 –¥–æ 10 –º–æ–¥–µ–ª–µ–π –Ω–µ –ø–æ–º–æ–≥–ª–æ (–¥–∞–∂–µ –Ω–µ–º–Ω–æ–≥–æ —É—Ö—É–¥—à–∏–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç).

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/ensemble_large.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~60 –º–∏–Ω—É—Ç

---

### 6. weighted_ensemble.py - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –º–æ–¥–µ–ª–µ–π –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è.

**–ú–µ—Ç–æ–¥:** scipy.optimize.minimize (SLSQP) –Ω–∞ validation set

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **91.02%** (—Ç–µ –∂–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –≤–µ—Å–∞ 0.1 –¥–ª—è –≤—Å–µ—Ö)

**–í—ã–≤–æ–¥:** ‚ùå –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ —É–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ.

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/weighted_ensemble.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5 –º–∏–Ω—É—Ç

---

### 7. test_time_augmentation.py - TTA –¥–ª—è 10 –º–æ–¥–µ–ª–µ–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å TTA –∫ –∞–Ω—Å–∞–º–±–ª—é 10 –º–æ–¥–µ–ª–µ–π.

**–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (5):**
1. Original
2. Horizontal flip
3. Rotation +5¬∞
4. Rotation -5¬∞
5. Flip + Rotation +5¬∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **91.13%** (+0.11% –Ω–∞–¥ baseline –∞–Ω—Å–∞–º–±–ª–µ–º 10 –º–æ–¥–µ–ª–µ–π)

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/test_time_augmentation.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç

---

### 8. tta_original_ensemble.py - TTA –¥–ª—è 5 –º–æ–¥–µ–ª–µ–π ‚≠ê

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å TTA –∫ –ª—É—á—à–µ–º—É –∞–Ω—Å–∞–º–±–ª—é (5 –º–æ–¥–µ–ª–µ–π).

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **91.26%** test accuracy üèÜ

**–£–ª—É—á—à–µ–Ω–∏–µ:** +0.10% –Ω–∞–¥ baseline –∞–Ω—Å–∞–º–±–ª–µ–º

**–í—ã–≤–æ–¥:** ‚úÖ –≠—Ç–æ –õ–£–ß–®–ò–ô —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–µ–∫—Ç–∞!

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/tta_original_ensemble.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç

---

### 9. best_models_ensemble.py - –¢–æ–ø-5 –∏–∑ 10

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–±—Ä–∞—Ç—å 5 –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π –∏–∑ 10 –æ–±—É—á–µ–Ω–Ω—ã—Ö.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **90.97%** (—Ö—É–∂–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è 5 –º–æ–¥–µ–ª–µ–π)

**–í—ã–≤–æ–¥:** ‚ùå –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –≤–∞–∂–Ω–µ–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏.

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/best_models_ensemble.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3 –º–∏–Ω—É—Ç—ã

---

### 10. visualize_results.py - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

**–°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
- `all_architectures_comparison.png` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ 7 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
- `augmentation_impact.png` - –≤–ª–∏—è–Ω–∏–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
- `summary_table.csv` - —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `progress_mlp_to_cnn.png` - –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç MLP –∫ CNN
- `benchmark_comparison.png` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏
- `confusion_matrix_placeholder.png` - —à–∞–±–ª–æ–Ω confusion matrix

**–ó–∞–ø—É—Å–∫:**
```bash
python scripts/python/visualize_results.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1 –º–∏–Ω—É—Ç–∞

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π

### ResNet-like CNN (–õ—É—á—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

```python
class ResNetLikeCNN(nn.Module):
    def __init__(self, num_classes=11, dropout=0.3, hidden_dim=64):
        super(ResNetLikeCNN, self).__init__()

        # –ù–∞—á–∞–ª—å–Ω—ã–π conv —Å–ª–æ–π
        self.conv1 = nn.Conv2d(1, hidden_dim, 3, padding=1)
        self.bn1 = nn.BatchNorm2d(hidden_dim)
        self.pool = nn.MaxPool2d(2, 2)

        # Residual blocks
        self.res_block1 = ResidualBlock(hidden_dim)
        self.res_block2 = ResidualBlock(hidden_dim)

        # Downsample layer
        self.conv2 = nn.Conv2d(hidden_dim, 128, 3, padding=1, stride=2)
        self.bn2 = nn.BatchNorm2d(128)

        # Classifier
        self.global_pool = nn.AdaptiveAvgPool2d(1)
        self.fc = nn.Linear(128, num_classes)
        self.dropout = nn.Dropout(dropout)

    def forward(self, x):
        x = F.relu(self.bn1(self.conv1(x)))
        x = self.pool(x)

        x = self.res_block1(x)  # Skip connections
        x = self.res_block2(x)  # Skip connections

        x = F.relu(self.bn2(self.conv2(x)))
        x = self.global_pool(x)
        x = x.view(x.size(0), -1)
        x = self.dropout(x)
        x = self.fc(x)
        return x


class ResidualBlock(nn.Module):
    def __init__(self, channels):
        super(ResidualBlock, self).__init__()
        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)
        self.bn1 = nn.BatchNorm2d(channels)
        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)
        self.bn2 = nn.BatchNorm2d(channels)

    def forward(self, x):
        residual = x
        out = F.relu(self.bn1(self.conv1(x)))
        out = self.bn2(self.conv2(out))
        out += residual  # Skip connection
        out = F.relu(out)
        return out
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Skip connections –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
- Batch Normalization –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ conv —Å–ª–æ—è
- Global Average Pooling –≤–º–µ—Å—Ç–æ flatten
- Dropout –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –ú–µ—Ç–æ–¥ | Test Accuracy | –£–ª—É—á—à–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-------|---------------|-----------|------------|
| **–û–¥–∏–Ω–æ—á–Ω—ã–µ –º–æ–¥–µ–ª–∏** ||||
| Baseline CNN | 89.96% | baseline | –ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
| DeepCNN | 89.35% | -0.61% | 4 conv —Å–ª–æ—è |
| BatchNormCNN | 88.81% | -1.15% | –° Batch Norm |
| ResNetLikeCNN | 89.42% | -0.54% | Skip connections |
| **ResNet-like + Higher LR** | **90.91%** | **+0.95%** | **–õ—É—á—à–∞—è –æ–¥–∏–Ω–æ—á–Ω–∞—è!** ‚≠ê |
| GlobalPoolCNN | 89.23% | -0.73% | Global pooling |
| LargeKernelCNN | 88.69% | -1.27% | Kernel 5√ó5 |
| **–° –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π** ||||
| ResNet-like (–±–µ–∑ aug) | 90.68% | +0.72% | –õ–µ–≥–∫–∞—è aug –ª—É—á—à–µ |
| + Horizontal Flip | 90.48% | +0.52% ||
| + Vertical Flip | 90.34% | +0.38% ||
| + Rotation ¬±10¬∞ | 90.24% | +0.28% ||
| + Rotation ¬±15¬∞ | 89.93% | -0.03% ||
| + Rotation ¬±20¬∞ | 89.45% | -0.51% | –°–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è |
| + Random Erasing | 89.12% | -0.84% | –°–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è |
| **–ê–Ω—Å–∞–º–±–ª–∏** ||||
| –ê–Ω—Å–∞–º–±–ª—å 5 –º–æ–¥–µ–ª–µ–π | 91.16% | +1.20% | –†–∞–∑–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã |
| –ê–Ω—Å–∞–º–±–ª—å 10 –º–æ–¥–µ–ª–µ–π | 91.02% | +1.06% | –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–µ –ø–æ–º–æ–≥–ª–æ |
| Weighted Ensemble | 91.02% | +1.06% | –†–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –≤–µ—Å–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã |
| –¢–æ–ø-5 –∏–∑ 10 –º–æ–¥–µ–ª–µ–π | 90.97% | +1.01% | –•—É–∂–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è |
| **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã** ||||
| TTA (10 –º–æ–¥–µ–ª–µ–π) | 91.13% | +1.17% | 5 —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π |
| **TTA (5 –º–æ–¥–µ–ª–µ–π)** | **91.26%** | **+1.30%** | **–õ–£–ß–®–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢!** üèÜ |

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏

| –ú–æ–¥–µ–ª—å | Test Accuracy | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|--------|---------------|----------|
| MLP Ensemble | 80.83% | –†–∞–±–æ—Ç–∞ 1_MLP |
| ResNet-18 | 87.7% | –°—Ç–∞—Ç—å—è MedMNIST v2 |
| OrganAMNIST (Axial) | 90.7% | –°—Ç–∞—Ç—å—è MedMNIST v2 |
| **–ù–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ê–Ω—Å–∞–º–±–ª—å + TTA)** | **91.26%** | **–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç** üèÜ |
| **–£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–¥ MLP** | **+10.43%** ||
| **–£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–¥ ResNet-18** | **+3.56%** ||
| **–£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–¥ OrganAMNIST** | **+0.56%** ||

---

## –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **CNN –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç MLP** (+10.43%)
   - –£—á–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫—Ä–∏—Ç–∏—á–µ–Ω
   - –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ª—É—á—à–µ —É–ª–∞–≤–ª–∏–≤–∞—é—Ç—Å—è CNN

2. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–∞–∂–Ω–µ–µ –≥–ª—É–±–∏–Ω—ã**
   - ResNet-like —Å skip connections –ª—É—á—à–µ –≥–ª—É–±–æ–∫–∏—Ö CNN
   - 28√ó28 - –º–∞–ª–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–∏–µ —Å–µ—Ç–∏ –Ω–µ –Ω—É–∂–Ω—ã

3. **Learning rate –∫—Ä–∏—Ç–∏—á–µ–Ω**
   - LR=0.002 –ª—É—á—à–µ LR=0.001 –Ω–∞ +1.49%
   - –ù—É–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

4. **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –º–∞–ª—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏**
   - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è (rotation >10¬∞, erasing) –£–•–£–î–®–ê–ï–¢ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –õ–µ–≥–∫–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è (flip, small rotation) —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ

5. **–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**
   - 5 —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –ª—É—á—à–µ 10 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö
   - –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
   - Soft voting —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ

6. **TTA –¥–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏—Ä–æ—Å—Ç**
   - +0.10% –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏—è—Ö
   - –•–æ—Ä–æ—à–æ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

–ß—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å >92% accuracy, –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:

1. **Transfer Learning**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (ImageNet)
   - Fine-tuning –Ω–∞ OrganCMNIST

2. **–ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**
   - EfficientNet-B0
   - Vision Transformers (ViT-Tiny)
   - MobileNet v3

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è**
   - AutoAugment
   - RandAugment
   - TrivialAugment

4. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è**
   - Mixup augmentation
   - CutMix augmentation
   - Label smoothing
   - Stochastic Depth

5. **–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤ –º–æ–¥–µ–ª–µ–π**
   - CNN + Transformers
   - –†–∞–∑–Ω—ã–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

### –§–∏–Ω–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∏–≥ —Å–≤–æ–∏—Ö —Ü–µ–ª–µ–π:
- ‚úÖ –ü—Ä–µ–≤–∑–æ—à–ª–∏ MLP –Ω–∞ +10.43%
- ‚úÖ –ü—Ä–µ–≤–∑–æ—à–ª–∏ ResNet-18 –Ω–∞ +3.56%
- ‚úÖ –ü—Ä–µ–≤–∑–æ—à–ª–∏ OrganAMNIST –Ω–∞ +0.56%
- ‚úÖ –î–æ—Å—Ç–∏–≥–ª–∏ state-of-the-art —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: **91.26%**

–î–∞–ª—å–Ω–µ–π—à–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ –º–æ–∂–µ—Ç –Ω–µ –æ–ø—Ä–∞–≤–¥–∞—Ç—å –∑–∞—Ç—Ä–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ CNN –∏ —Ç–µ—Ö–Ω–∏–∫ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [MedMNIST Paper](https://www.nature.com/articles/s41597-022-01721-8)
- [MedMNIST Website](https://medmnist.com/)
- [PyTorch Documentation](https://pytorch.org/docs/stable/index.html)
- [Deep Residual Learning (ResNet Paper)](https://arxiv.org/abs/1512.03385)
- [Batch Normalization Paper](https://arxiv.org/abs/1502.03167)

---

**–ê–≤—Ç–æ—Ä:** –ü—Ä–æ–µ–∫—Ç 2_CNN
**–î–∞—Ç–∞:** –Ø–Ω–≤–∞—Ä—å 2026
**–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 91.26% test accuracy üèÜ
